<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link rel="icon" href="img/favicon.png" type="image/png" />
    <title>Thanh toán</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.css" />
    <link rel="stylesheet" href="vendors/linericon/style.css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link rel="stylesheet" href="css/themify-icons.css" />
    <link rel="stylesheet" href="vendors/owl-carousel/owl.carousel.min.css" />
    <link rel="stylesheet" href="vendors/lightbox/simpleLightbox.css" />
    <link rel="stylesheet" href="vendors/nice-select/css/nice-select.css" />
    <link rel="stylesheet" href="vendors/animate-css/animate.css" />
    <link rel="stylesheet" href="vendors/jquery-ui/jquery-ui.css" />
    <!-- main css -->
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/responsive.css" />
  </head>

  <body>
    <!--================Header Menu Area =================-->
    <header class="header_area">
      <div class="top_menu">
        <div class="container">
          <div class="row">
            <div class="col-lg-7">
              <div class="float-left">
                <p>Phone: +01 256 25 235</p>
                <p>email: info@eiser.com</p>
              </div>
            </div>
            <div class="col-lg-5">
              <div class="float-right">
                <ul class="right_side">
                  <li>
                    <a href="cart.html"> Giỏ hàng </a>
                  </li>
                  <li>
                    <a href="tracking.html"> Theo dõi </a>
                  </li>
                  <li>
                    <a href="contact.html"> Liên hệ </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="main_menu">
        <div class="container">
          <nav class="navbar navbar-expand-lg navbar-light w-100">
            <!-- Brand and toggle get grouped for better mobile display -->
            <a class="navbar-brand logo_h" href="index.html">
              <img src="img/logo.png" alt="" />
            </a>
            <button
              class="navbar-toggler"
              type="button"
              data-toggle="collapse"
              data-target="#navbarSupportedContent"
              aria-controls="navbarSupportedContent"
              aria-expanded="false"
              aria-label="Toggle navigation"
            >
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div
              class="collapse navbar-collapse offset w-100"
              id="navbarSupportedContent"
            >
              <div class="row w-100 mr-0">
                <div class="col-lg-7 pr-0">
                  <ul class="nav navbar-nav center_nav pull-right">
                    <li class="nav-item">
                      <a class="nav-link" href="index.html">Trang chủ</a>
                    </li>
                    <li class="nav-item active submenu dropdown">
                      <a
                        href="#"
                        class="nav-link dropdown-toggle"
                        data-toggle="dropdown"
                        role="button"
                        aria-haspopup="true"
                        aria-expanded="false"
                        >Shop</a
                      >
                      <ul class="dropdown-menu">
                        <li class="nav-item">
                          <a class="nav-link" href="category.html">Danh mục</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="single-product.html"
                            >Chi tiết sản phẩm</a
                          >
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="checkout.html"
                            >Kiểm tra sản phẩm</a
                          >
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="cart.html">Giỏ hàng</a>
                        </li>
                      </ul>
                    </li>
                    <li class="nav-item submenu dropdown">
                      <a
                        href="#"
                        class="nav-link dropdown-toggle"
                        data-toggle="dropdown"
                        role="button"
                        aria-haspopup="true"
                        aria-expanded="false"
                        >Blog</a
                      >
                      <ul class="dropdown-menu">
                        <li class="nav-item">
                          <a class="nav-link" href="blog.html">Blog</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="single-blog.html"
                            >Blog Details</a
                          >
                        </li>
                      </ul>
                    </li>
                    <li class="nav-item submenu dropdown">
                      <a
                        href="#"
                        class="nav-link dropdown-toggle"
                        data-toggle="dropdown"
                        role="button"
                        aria-haspopup="true"
                        aria-expanded="false"
                        >Pages</a
                      >
                      <ul class="dropdown-menu">
                        <li class="nav-item">
                          <a class="nav-link" href="tracking.html">Tracking</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="elements.html">Elements</a>
                        </li>
                      </ul>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="contact.html">liên hệ</a>
                    </li>
                  </ul>
                </div>

                <div class="col-lg-5 pr-0">
                  <ul class="nav navbar-nav navbar-right right_nav pull-right">
                    <li class="nav-item">
                      <a href="#" class="icons">
                        <i class="ti-search" aria-hidden="true"></i>
                      </a>
                    </li>

                    <li class="nav-item">
                      <a href="cart.html" class="icons">
                        <i class="fa fa-shopping-bag soluong"></i>
                        <span id="soluong">0</span>
                        <div id="quantityincart"></div>
                      </a>
                    </li>

                    <li class="nav-item">
                      <a href="#" class="icons">
                        <i class="ti-user" aria-hidden="true"></i>
                      </a>
                    </li>

                    <li class="nav-item">
                      <a href="#" class="icons">
                        <i class="ti-heart" aria-hidden="true"></i>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </nav>
        </div>
      </div>
    </header>
    <!--================Header Menu Area =================-->

    <!--================Home Banner Area =================-->
    <section class="banner_area">
      <div class="banner_inner d-flex align-items-center">
        <div class="container">
          <div
            class="banner_content d-md-flex justify-content-between align-items-center"
          >
            <div class="mb-3 mb-md-0">
              <h2>Product Checkout</h2>
              <p>Very us move be blessed multiply night</p>
            </div>
            <div class="page_link">
              <a href="index.html">Trang chủ</a>
              <a href="checkout.html">Thanh toán</a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!--================End Home Banner Area =================-->

    <!--================Checkout Area =================-->
    <section class="checkout_area section_gap">
      <div class="container">
        <div class="billing_details">
          <div class="row">
            <div class="col-lg-8">
              <h3>Chi tiết thanh toán</h3>
              <form
                class="row contact_form"
                action="#"
                method="post"
                novalidate="novalidate"
              >
                <div class="col-md-6 form-group p_star">
                  <input
                    type="text"
                    class="form-control"
                    id="name"
                    name="name"
                    placeholder="Họ và tên"
                  />

                  <span id="erorName" class="error"></span>
                </div>
                <div class="col-md-6 form-group p_star">
                  <input
                    type="text"
                    class="form-control"
                    id="phone"
                    name="number"
                    placeholder="Số điện thoại"
                  />
                  <span id="erorPhone" class="error"></span>
                </div>
                <div class="col-md-6 form-group p_star">
                  <input
                    type="text"
                    class="form-control"
                    id="email"
                    name="compemailany"
                    placeholder="Email"
                  />
                  <span id="erorEmail" class="error"></span>
                </div>
                <div class="col-md-6 form-group p_star">
                  <input
                    type="text"
                    class="form-control"
                    id="address"
                    name="compemailany"
                    placeholder="Địa chỉ"
                  />
                  <span id="erorAddress" class="error"></span>
                </div>

                <div class="col-md-12 form-group">
                  <div class="creat_account">
                    <input type="checkbox" id="f-option2" name="selector" />
                    <label for="f-option2">Tạo tài khoản?</label>
                  </div>
                </div>
                <div class="col-md-12 form-group">
                  <div class="creat_account">
                    <h3>Chi tiết vận chuyển</h3>
                    <input type="checkbox" id="f-option3" name="selector" />
                    <label for="f-option3">Vận chuyển tới địa chỉ khác?</label>
                  </div>
                  <textarea
                    class="form-control"
                    name="message"
                    id="message"
                    rows="1"
                    placeholder="Ghi chú"
                  ></textarea>
                </div>
              </form>
            </div>
            <div class="col-lg-4">
              <div class="order_box">
                <h2>Đơn hàng của bạn</h2>
                <ul class="list" id="list">
                  <li>
                    <a href="#"
                      >Sản phẩm
                      <span>Tổng</span>
                    </a>
                  </li>
                </ul>
                <ul class="list list_2">
                  <li>
                    <a href="#"
                      >Tổng tiền
                      <span id="tongtien"></span>
                    </a>
                  </li>
                </ul>
                <input
                  type="submit"
                  class="genric-btn primary circle"
                  id="btnDatHang"
                  onclick="datHang()"
                  value="Đặt hàng"
                />
                <!-- <button
                  class="genric-btn primary circle"
                  id="btnDatHang"
                  onclick="datHang()"
                >
                  Đặt hàng
                </button> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!--================End Checkout Area =================-->

    <!--================ start footer Area  =================-->
    <footer class="footer-area section_gap">
      <div class="container">
        <div class="row">
          <div class="col-lg-2 col-md-6 single-footer-widget">
            <h4>Top Products</h4>
            <ul>
              <li><a href="#">Managed Website</a></li>
              <li><a href="#">Manage Reputation</a></li>
              <li><a href="#">Power Tools</a></li>
              <li><a href="#">Marketing Service</a></li>
            </ul>
          </div>
          <div class="col-lg-2 col-md-6 single-footer-widget">
            <h4>Quick Links</h4>
            <ul>
              <li><a href="#">Jobs</a></li>
              <li><a href="#">Brand Assets</a></li>
              <li><a href="#">Investor Relations</a></li>
              <li><a href="#">Terms of Service</a></li>
            </ul>
          </div>
          <div class="col-lg-2 col-md-6 single-footer-widget">
            <h4>Features</h4>
            <ul>
              <li><a href="#">Jobs</a></li>
              <li><a href="#">Brand Assets</a></li>
              <li><a href="#">Investor Relations</a></li>
              <li><a href="#">Terms of Service</a></li>
            </ul>
          </div>
          <div class="col-lg-2 col-md-6 single-footer-widget">
            <h4>Resources</h4>
            <ul>
              <li><a href="#">Guides</a></li>
              <li><a href="#">Research</a></li>
              <li><a href="#">Experts</a></li>
              <li><a href="#">Agencies</a></li>
            </ul>
          </div>
          <div class="col-lg-4 col-md-6 single-footer-widget">
            <h4>Newsletter</h4>
            <p>You can trust us. we only send promo offers,</p>
            <div class="form-wrap" id="mc_embed_signup">
              <form
                target="_blank"
                action="https://spondonit.us12.list-manage.com/subscribe/post?u=1462626880ade1ac87bd9c93a&amp;id=92a4423d01"
                method="get"
                class="form-inline"
              >
                <input
                  class="form-control"
                  name="EMAIL"
                  placeholder="Your Email Address"
                  onfocus="this.placeholder = ''"
                  onblur="this.placeholder = 'Your Email Address '"
                  required=""
                  type="email"
                />
                <button class="click-btn btn btn-default">Subscribe</button>
                <div style="position: absolute; left: -5000px">
                  <input
                    name="b_36c4fd991d266f23781ded980_aefe40901a"
                    tabindex="-1"
                    value=""
                    type="text"
                  />
                </div>

                <div class="info"></div>
              </form>
            </div>
          </div>
        </div>
        <div class="footer-bottom row align-items-center">
          <p class="footer-text m-0 col-lg-8 col-md-12">
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;
            <script>
              document.write(new Date().getFullYear());
            </script>
            All rights reserved | This template is made with
            <i class="fa fa-heart-o" aria-hidden="true"></i> by
            <a href="https://colorlib.com" target="_blank">Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
          </p>
          <div class="col-lg-4 col-md-12 footer-social">
            <a href="#"><i class="fa fa-facebook"></i></a>
            <a href="#"><i class="fa fa-twitter"></i></a>
            <a href="#"><i class="fa fa-dribbble"></i></a>
            <a href="#"><i class="fa fa-behance"></i></a>
          </div>
        </div>
      </div>
    </footer>
    <!--================ End footer Area  =================-->
    <script>
      // document.querySelector("#btnDatHang").onclick = function () {
      //   name = document.querySelector("#name").value.trim();
      //   email = document.querySelector("#email").value.trim();
      //   dienthoai = document.querySelector("#dienthoai").value.trim();
      //   diachi = document.querySelector("#diachi").value.trim();
      //   if (name == "") {
      //     // alert("Tên không được để trống");
      //     mess = document.getElementById("message");
      //     mess.innerHTML = "Họ tên không được để trống";
      //     return;
      //   }
      //   if (diachi == "") {
      //     mess = document.getElementById("message");
      //     mess.innerHTML = "Họ tên không được để trống";
      //     // alert("Địa chỉ không được để trống");
      //     return;
      //   }
      //   if (email == "") {
      //     alert("Email không được để trống");
      //     return;
      //   }
      //   if (dienthoai == "") {
      //     alert("Điện thoại không được để trống");
      //     return;
      //   }
      //   alert("Chào bạn");

      function datHang() {
        var name = document.getElementById("name").value;
        var erorName = document.getElementById("erorName");
        var regexName = /^[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]*$/;

        if (name == "" || name == null) {
          erorName.innerHTML = "Họ tên không được để trống!";
          return false;
        } else if (regexName.test(name)) {
          erorName.innerHTML = "Họ tên không hợp lệ!";
          return false;
        } else {
          erorName.innerHTML = "";
        }

        var phone = document.getElementById("phone").value;
        var erorPhone = document.getElementById("erorPhone");
        var regexPhone =
          /^(0?)(3[2-9]|5[6|8|9]|7[0|6-9]|8[0-6|8|9]|9[0-4|6-9])[0-9]{7}$/;
        if (phone == "" || phone == null) {
          erorPhone.innerHTML = "Số điện thoại không được để trống!";
          return false;
        } else if (!regexPhone.test(phone)) {
          erorPhone.innerHTML = "SĐT không hợp lệ!";
          return false;
        } else {
          erorPhone.innerHTML = "";
        }

        var email = document.getElementById("email").value;
        var errorEmail = document.getElementById("erorEmail");
        var reGexEmail =
          /^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;
        if (email == "" || email == null) {
          errorEmail.innerHTML = "Email không được để trống!";
          return false;
        } else if (!reGexEmail.test(email)) {
          errorEmail.innerHTML = "Email không hợp lệ!";
          return false;
        } else {
          errorEmail.innerHTML = "";
        }

        var address = document.getElementById("address").value;
        var erorAddress = document.getElementById("erorAddress");
        var reGexAddress = /^(?=.*\d)(?=.*[a-zA-Z]).{10,}$/;
        if (address == "" || address == null) {
          erorAddress.innerHTML = "Địa chỉ không được để trống!";
          return false;
        } else if (!reGexAddress.test(address)) {
          erorAddress.innerHTML = "Địa chỉ không hợp lệ!";
          return false;
        } else {
          erorAddress.innerHTML = "";
        }

        var url = "http://localhost:3000/orders";
        var donhang = {
          customer_name: document.querySelector("#name").value.trim(),
          customer_address: document.querySelector("#address").value.trim(),
          customer_phone: document.querySelector("#phone").value.trim(),
          customer_email: document.querySelector("#email").value.trim(),
          create_date: new Date().toISOString().slice(0, 10),
          status: "Chờ xác nhận",
        };
        options = {
          method: "post",
          body: JSON.stringify(donhang),
          headers: { "Content-Type": "application/json" },
        };
        fetch(url, options)
          .then((res) => res.json())
          .then((orders) => {
            order_id = orders.id;
            customer_address = orders.customer_address;
            customer_phone = orders.customer_phone;
            customer_name = orders.customer_name;
            LuuChiTietDonHang(
              order_id,
              customer_address,
              customer_phone,
              customer_name
            );
          });
        // document.location = "./index.html";
      }
    </script>
    <script>
      function LuuChiTietDonHang(order_id) {
        let cart = JSON.parse(localStorage.getItem("cart"));
        cart.forEach((product) => {
          console.log(product);
          let objSP = {
            order_id: order_id,
            product_id: product.id,
            order_name: product.name,
            order_address: customer_address,
            order_phone: customer_phone,
            order_customerName: customer_name,
            quantity: product.quantity,
            unti_price: product.price,
          };
          console.log(objSP);
          url = "http://localhost:3000/order_details";
          options = {
            method: "post",
            body: JSON.stringify(objSP),
            headers: { "Content-Type": "application/json" },
          };
          fetch(url, options)
            .then((res) => res.json())
            .then((d) => {
              document.location = "./index.html";
              alert("Đặt hàng thành công");
              localStorage.removeItem("cart");
            });
        });
      }
    </script>

    <script>
      // hiển thị sản phẩm trong giỏ hàng ra trang thanh toán
      var cart = JSON.parse(localStorage.getItem("cart"));

      if (cart) {
        cart.map((product, index) => {
          document.querySelector("#list").innerHTML += `
                  <li>
                    <a href="#"
                      >${product.name}
                      <span class="middle">x ${product.quantity}</span>
                      <span class="last">${
                        product.price * product.quantity
                      }</span>
                    </a>
                  </li>
          `;
        });
      }
    </script>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/popper.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/stellar.js"></script>
    <script src="vendors/lightbox/simpleLightbox.min.js"></script>
    <script src="vendors/nice-select/js/jquery.nice-select.min.js"></script>
    <script src="vendors/isotope/imagesloaded.pkgd.min.js"></script>
    <script src="vendors/isotope/isotope-min.js"></script>
    <script src="vendors/owl-carousel/owl.carousel.min.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/mail-script.js"></script>
    <script src="vendors/jquery-ui/jquery-ui.js"></script>
    <script src="vendors/counter-up/jquery.waypoints.min.js"></script>
    <script src="vendors/counter-up/jquery.counterup.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/tinhtien.js"></script>
    <script src="js/soluong.js"></script>
  </body>
</html>
